# ERM (WoG/Era) Syntax for VS Code

Расширение добавляет полноценную подсветку синтаксиса, автозакрытие скобок и набор сниппетов для ERM‑скриптов Heroes of Might and Magic III (WoG/Era). Оно построено поверх TextMate грамматики и автоматически активируется для проектов с файлами `*.erm`, `*.ers` и `*.erw`.

## Возможности

- Точные правила подсветки для заголовка `ZVSE`, триггеров `!?XX`, команд `!!XX`, получателей (`HE`, `VR`, `DO`, `SN`, `CM` и десятки других), а также переменных `v1`, `f42`, `y12345` и т.д.
- Распознавание чисел, строк, логических операторов и служебных символов, что делает сложные конструкции ERM легче читаемыми.
- Поддержка линейных (`*`) и точечных (`;`) комментариев, а также авто‑/обрамления скобок `()[]{}` и кавычек согласно `language-configuration.json`.
- Сниппеты для часто повторяющихся конструкций ERM: заготовка триггера, функции `FU` и цикла `DO`.

## Быстрый старт

1. Установите расширение через VSIX или marketplace (как только публикация будет доступна).
2. Откройте любой ERM‑файл. VS Code переключится на язык `ERM`, и расширение активируется (событие `onLanguage:erm`).
3. Наберите `erm-trigger`, `erm-fu` или `erm-do`, чтобы вставить готовый шаблон.

## Каталог сниппетов

| Префикс      | Назначение                  | Что вставляет |
|--------------|-----------------------------|---------------|
| `erm-trigger`| Минимальный триггер         | `ZVSE`, шапка `!?PI`, пример команды `CM` |
| `erm-fu`     | Шаблон функции `FU`          | Объявление `FU(100)`, пример `VR`, `IF` блок |
| `erm-do`     | Цикл `DO` по диапазону       | `!!DOx/start/end/step/:proc` |

Каждый сниппет содержит комментарии-подсказки и табстопы для быстрого заполнения параметров.

## Подсветка и грамматика

Ниже приведен пример кода, демонстрирующий выделение ключевых элементов:

```erm
ZVSE
* Player interaction trigger
!?PI;
!!IF&v1>0:;
!!VRv2:S1;
!!DOWZ/1/6/1/:101;
"Action: player ${v1}"
;
```

Грамматика (`syntaxes/erm.tmLanguage.json`) выделяет:

- `keyword.declaration.header.erm` — шапку `ZVSE`.
- `keyword.control.trigger.erm` — строки `!?XX`.
- `keyword.control.command.erm` — команды `!!XX`.
- `support.class.receiver.erm` — получателей вроде `HE`, `VR`, `CM`.
- `variable.other.erm` — переменные `v`, `y`, `e`, `i`, `t`, `r`, `w`, `z`, `f`, `d`, `g`, `q`, `s`, `p`, `l`, `m`, `r`, `c`, `b`, `n`, `x`, `h`, `k` с индексами.
- `keyword.operator.*` — операторы `:`, `=`, `&`, `|`, `<=`, `>=` и другие.

## Разработка и сборка

В проекте уже настроен TypeScript и типы VS Code 1.105. Используйте npm‑скрипты:

- `npm run compile` — одноразовая сборка в `out/`.
- `npm run watch` — инкрементальная сборка при разработке.
- `npm run package` — упаковка VSIX через `vsce`.

Перед публикацией выполните `npm install`, затем `npm run vscode:prepublish`.

## Release Notes

### 0.0.1

- Первая версия: грамматика ERM, конфигурация языка, набор начальных сниппетов и события активации языка.

## Обратная связь

Сообщайте об ошибках и идеях в issues репозитория `Kypaku/erm-vscode-syntax`. Приветствуются предложения по дополнению грамматики новыми получателями и командам ERM.
